<!DOCTYPE html>
<html>
<body>
    <button id='Quick Sort'>Quick Sort</button>
    <button id='Selection Sort'>Selection Sort</button>
    <button id='Bubble Sort'>Bubble Sort</button>
    <button id='Merge Sort'>Merge Sort</button>
    <button id='Shell Sort'>Shell Sort</button>
    <button id='Cocktail Sort'>Cocktail Sort</button>
    <button id='Gnome Sort'>Insertion Sort</button>
    <button id='Know Sort' style="margin-left:300px;">Know Sort</button>
    <button id='Know Sort 2'>Know Sort 2</button>
    <button id='Cool Sort'>Cool Sort</button>
    <br>
    <br>
    <div></div>
    <canvas id="myCanvas" width="1400" height="650" style="border:1px solid #2a1baf;"></canvas>

    <input type="range" min="4" max="2000" value="1" class="slider" id="slider">
    Amount of Rectangles: <span id="choice"></span>
    <br>
    <input type="range" min="1" max = "5" value="1" class="slideSpeed" id="slideSpeed">
    Speed: <span id="speed"></span>
    <div></div>
    <br>
    <button id='New'>Generate New Array</button>
    <button id="Stop">Pause</button>

    <script>
        var mode = "None";
        var lastMode = "None";
        var active = -1;
        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");
        var slider = document.getElementById("slider");
        var slideSpeed = document.getElementById("slideSpeed");
        var slideText = document.getElementById("choice");
        var speedText = document.getElementById("speed");
        var await = 0;
        var await2 = 0;
        var size = 4;
        var speed = 1;
        var minIndex = -1;
        slideText.innerHTML = size;
        speedText.innerHTML = speed;
        var arr = reset(size ,[]);
        var visited = [];
        var iterated = [];
        var buttonGen = document.getElementById('New');
        var buttonStop = document.getElementById('Stop');
        var buttonQuick = document.getElementById('Quick Sort');
        var buttonBubble = document.getElementById('Bubble Sort');
        var buttonMerge = document.getElementById('Merge Sort');
        var buttonShell = document.getElementById('Shell Sort');
        var buttonCocktail = document.getElementById('Cocktail Sort');
        var buttonGnome = document.getElementById('Gnome Sort');
        var buttonKnow = document.getElementById('Know Sort');
        var buttonKnow2 = document.getElementById('Know Sort 2');
        var buttonCool = document.getElementById('Cool Sort');
        var buttonSelection = document.getElementById('Selection Sort');

        buttonGen.onclick = function() {
            minIndex = -1;
            lastMode = mode;
            mode = "None";
            arr = reset(arr.length);
        }
        buttonStop.onclick = function() {
            if (mode == "Cool") {
                await = 1;
            }
            if (mode == "Select") {
                await2 = 1;
            }
            lastMode = mode;
            mode = "None";      
        }
        /*
        buttonResume.onclick = function() {
            if (lastMode != "None") {
                mode = lastMode;
            }
            if (mode == "Quick") {
                quicksort();
            }
            else if (mode == "Bubble") {
                bubblesort();
            }
            else if (await2 == 1) {
                await2 = 0;
                mode = "Select";
                selectionsort();
            }
            else if (mode == "Merge") {
                visited = [];
                iterated = [];
                for (let i = 0; i < arr.length; i++) {
                    iterated.push(0);
                    visited.push(0);
                }
                mergesort(0, arr.length - 1);
            }
            else if (mode == "Know") {
                knowSort();
            }
            else if (mode == "Know2") {
                knowSort2();
            }
            else if (await == 1) {
                await = 0;
                mode = "Cool";
                coolSort();
            }
        }
        */
        buttonQuick.onclick = function() {
            minIndex = -1;
            if (mode != "Quick") {
                lastMode = mode;
                mode = "Quick";
                quicksort();
            }
        }
        buttonBubble.onclick = function() {
            minIndex = -1;
            if (mode != "Bubble") {
                lastMode = mode;
                mode = "Bubble";
                bubblesort();
            }
        }
        buttonSelection.onclick = function() {
            minIndex = -1;
            if (mode != "Select") {
                lastMode = mode;
                mode = "Select";
                selectionsort();
            }
        }
        buttonMerge.onclick = function() {
            minIndex = -1;
            if (mode != "Merge") {
                lastMode = mode;
                mode = "Merge";
                visited = [];
                iterated = [];
                for (let i = 0; i < arr.length; i++) {
                    iterated.push(0);
                    visited.push(0);
                }
                mergesort(0, arr.length - 1);
            }
        }
        buttonShell.onclick = function() {
            minIndex = -1;
            if (mode != "Shell") {
                lastMode = mode;
                mode = "Shell";
                shellsort();
            }
        }
        buttonCocktail.onclick = function() {
            minIndex = -1;
            if (mode != "Cocktail") {
                lastMode = mode;
                mode = "Cocktail";
                cocktailsort();
            }
        }
        buttonGnome.onclick = function() {
            minIndex = -1;
            if (mode != "Gnome") {
                lastMode = mode;
                mode = "Gnome";
                gnomesort();
            }
        }
        buttonKnow.onclick = function() {
            minIndex = -1;
            if (mode != "Know") {
                lastMode = mode;
                mode = "Know";
                knowSort();
            }
        }
        buttonKnow2.onclick = function() {
            minIndex = -1;
            if (mode != "Know2") {
                lastMode = mode;
                mode = "Know2";
                knowSort2();
            }
        }
        buttonCool.onclick = function() {
            minIndex = -1;
            if (mode != "Cool") {
                lastMode = mode;
                mode = "Cool";
                coolSort();
            }
        }
        slider.oninput = function() {
            minIndex = -1;
            lastMode = mode;
            mode = "None";
            slideText.innerHTML = this.value;
            size = this.value;
            ctx.clearRect(0, 0, c.width, c.height);
            arr = reset(size);
        }
        slideSpeed.oninput = function() {
            speedText.innerHTML = this.value;
            speed = this.value;
        }

        async function shellsort() {
            for (let i = Math.floor(arr.length / 2); i > 0; i = Math.floor(i / 2)) {
                if (mode != "Shell") {
                    break;
                }
                for (let j = i; j < arr.length; j++) {
                    if (mode != "Shell") {
                        break;
                    }
                    active = j;
                    let temp = arr[j];
                    let k;
                    for (k = j; k >= i && arr[k - i] > temp; k -= i) {
                        if (mode != "Shell") {
                            break;
                        }
                        active = k;
                        if (speed == 1) {
                            await sleep(500);
                        }
                        else if (speed == 2) {
                            await sleep(100);
                        }
                        else if (speed == 3) {
                            await sleep(20);
                        }
                        else if (speed == 4) {
                            await sleep();
                        }
                        arr[k] = arr[k - i];
                        reset(arr.length, arr);
                    }
                    arr[k] = temp;
                    reset(arr.length, arr);
                }
            }
        }
        function reset(size, ar = []) {
            nums = [];
            slide = false;
            if (ar == "") {
                for (let i = 1; i <= size; i++) {
                    nums.push(i);
                    slide = true;
                }
                while (nums.length > 0) {
                    const random = Math.floor(Math.random() * nums.length);
                    ar.push(nums[random]);
                    nums.splice(random, 1);
                }
            }
            ctx.clearRect(0, 0, c.width, c.height);
            for (let i = 0; i < size; i++) {
                ctx.fillStyle = 'black';
                if (i == active) {
                    ctx.fillStyle = 'blue';
                }
                else if (i == minIndex) {
                    ctx.fillStyle = 'red';
                }
                else if (i == ar[i] - 1) {
                    ctx.fillStyle = 'green';
                }
                ctx.fillRect(i * (1400 / size), 0, 1400 / size, 600 / (size) * ar[i]);
            }
            return ar;
        }
        async function bin_search(arr, val, start, end) {
            active = start;
            reset(arr.length, arr);
            while (mode == "Quick") {
                if (speed == 1) {
                    await sleep(500);
                }
                else if (speed == 2) {
                    await sleep(100);
                }
                else if (speed == 3) {
                    await sleep(20);
                }
                else if (speed == 4) {
                    await sleep();
                }
                if (start == end) {
                    if (arr[start] > val) {
                        return start;
                    }
                    else {
                        return start + 1;
                    }
                }
                if (start > end) {
                    return start;
                }
                var mid = Math.floor((start + end) / 2);
                if (arr[mid] < val) {
                    return bin_search(arr, val, mid + 1, end);
                }
                else if (arr[mid] > val) {
                    return bin_search(arr, val, start, mid - 1);
                }
                else {
                    return mid;
                }
            }
        }
        async function quicksort() {
            let i = 0;
            while (i < arr.length) {
                active = i;
                if (mode != "Quick") {
                    break;
                }
                let val = arr[i];
                let j = await bin_search(arr, val, 0, i - 1);
                let slice2 = arr.slice(j, i);
                let slice3 = arr.slice(i + 1);
                arr = arr.slice(0, j);
                arr.push(val);
                arr = arr.concat(slice2);
                arr = arr.concat(slice3);
                reset(arr.length, arr);
                i++;
            }
            lastMode = mode;
            mode = "None";
            active = -1;
        }
        async function swap(a, b) {
            if (speed == 1) {
                await sleep(500);
            }
            else if (speed == 2) {
                await sleep(100);
            }
            else if (speed == 3) {
                await sleep(50);
            }
            else if (speed == 4) {
                await sleep(10);
            }
            else {
                await sleep();
            }
            temp1 = arr[a];
            arr[a] = arr[b];
            arr[b] = temp1;
        }
        async function swapKnow(a, b) {
            if (speed == 1) {
                await sleep(500);
            }
            else if (speed == 2) {
                await sleep(100);
            }
            else if (speed == 3) {
                await sleep(30);
            }
            else if (speed == 4) {
                await sleep();
            }
            temp1 = arr[a];
            arr[a] = arr[b];
            arr[b] = temp1;
        }

        async function bubblesort() {
            for (let i = 0; i < arr.length; i++) {
                sorted = true;
                for (let j = 0; j < arr.length - i - 1; j++) {
                    active = j;
                    if (arr[j] > arr[j + 1]) {
                        await swap(j, j + 1);
                        reset(arr.length, arr);
                        sorted = false;
                    }
                    if (mode != "Bubble") {
                        break;
                    }
                }
                if (mode != "Bubble") {
                    break;
                }
                if (sorted) {
                    break;
                }
            }
            lastMode = mode;
            mode = "None";
            active = -1;
        }

        async function selectionsort() {
            for (let i = 0; i < arr.length; i++) {
                if (mode != "Select") {
                    break;
                }
                minIndex = i;
                for (let j = i; j < arr.length; j++) {
                    if (mode != "Select") {
                        break;
                    }
                    active = j;
                    if (arr[j] < arr[minIndex]) {
                        minIndex = j;
                    }
                    await swap(1, 1);
                    reset(arr.length, arr);
                }
                await swap(i, minIndex);
                reset(arr.length, arr);
            }
            lastMode = mode;
            mode = "None";
            active = -1;
        }

        async function merge(start, end) {
            let mid = Math.floor((start + end) / 2);
            let startOne = start;
            let startTwo = mid + 1;
            let endOne = mid;
            let endTwo = end;
            let index = start;
            while (startOne <= endOne && startTwo <= endTwo) {
                if (mode != "Merge") {
                    break;
                }
                if (arr[startOne] <= arr[startTwo]) {
                    iterated[index] = arr[startOne];
                    index++;
                    startOne++;
                }
                else if(arr[startOne] > arr[startTwo]) {
                    iterated[index] = arr[startTwo];
                    index++;
                    startTwo++;
                }
            }
            while (startOne <= endOne) {
                if (mode != "Merge") {
                    break;
                }
                iterated[index] = arr[startOne]
                index++;
                startOne++;
            }
            while (startTwo <= endTwo) {
                if (mode != "Merge") {
                    break;
                }
                iterated[index] = arr[startTwo];
                index++;
                startTwo++;
            }
            index = start
            while (index < end + 1) {
                active = index;
                if (mode != "Merge") {
                    break;
                }
                arr[index] = iterated[index];
                if (speed == 1) {
                    await sleep(200);
                }
                else if (speed == 2) {
                    await sleep(50);
                }
                else if (speed == 3) {
                    await sleep(10);
                }
                else {
                    await sleep();
                }
                reset(arr.length, arr);
                index++;
            }
        }
        
        async function mergesort(start, end) {
            if (mode == "Merge") {
                if (start < end) {
                    let mid = Math.floor((start + end) / 2);
                    await mergesort(start, mid);
                    await mergesort(mid + 1, end);
                    await merge(start, end);
                    reset(arr.length, arr);
                }
            }
        }

        async function cocktailsort() {
            let recurse = 0;
            while (!isSorted()) {
                if (mode != "Cocktail") {
                    break;
                }
                if (recurse % 2 == 0) {
                    for (let i = 0; i < arr.length - 1; i++) {
                        if (mode != "Cocktail") {
                            break;
                        }
                        reset(arr.length, arr);
                        active = i
                        if (arr[i] > arr[i + 1]) {
                            await swap(i, i + 1);
                        }
                    }
                }
                else {
                    for (let i = arr.length - 1; i > 0; i--) {
                        if (mode != "Cocktail") {
                            break;
                        }
                        reset(arr.length, arr);
                        active = i
                        if (arr[i] < arr[i - 1]) {
                            await swap(i, i - 1);
                        }
                    }
                }
                recurse++;
            }
            lastMode = mode;
            mode = "None";
            active = -1;
        }

        async function gnomesort() {
            for (var i = 0; i < arr.length; i++) {
                for (var j = i; j > 0; j--) {
                    active = j;
                    if (arr[j] < arr[j - 1]) {
                        await swap(j, j - 1);
                        reset(arr.length, arr);
                    }
                }
            }
        }

        function isSorted() {
            for (let i = 0; i < arr.length; i++) {
                if (arr[i] != i + 1) {
                    return false;
                }
            }
            return true;
        }

        async function knowSort() {
            for (let i = 0; i < arr.length; i++) {
                active = i;
                while (arr[i] != i + 1) {
                    if (mode != "Know") {
                        break;
                    }
                    await swapKnow(i, arr[i] - 1);
                    reset(arr.length, arr);
                }
                if (mode != "Know") {
                    break;
                }
            }
            lastMode = mode;
            mode = "None";
            active = -1;
        }

        async function knowSort2() {
            sorted = false;
  	        while (!sorted) {
                if (mode != "Know2") {
                    break;
                }
      	        sorted = true;
      	        for (let i = 0; i < arr.length; i++) {
                    active = i;
                    if (mode != "Know2") {
                        break;
                    }
        	        if (arr[arr[i] - 1] > arr[i]) {
              	        sorted = false;
                    }
        	        await swapKnow(i, arr[i] - 1);
                    reset(arr.length, arr);
      	        }
            }
            lastMode = mode;
            mode = "None";
            active = -1;
        }
        async function coolSort() {
            for (let i = 0, j = arr.length - 1; i < j; i++) {
                if (mode != "Cool") {
                    break;
                }
                await swapKnow(i, arr.indexOf(i + 1));
                active = i;
                reset(arr.length, arr);
                await swapKnow(j, arr.indexOf(j + 1));
                active = j;
                reset(arr.length, arr);
                j--;
            }
            lastMode = mode;
            mode = "None";
            active = -1;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>
